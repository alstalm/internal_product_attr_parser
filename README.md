# internal_product_attr_parser
## Общее описание:
Данный скрипт парсит API НК по методу internal-product и извлекает значение атрибута заданного в столбце NK_AttrId для гтина, заданного в столбце NK_GTIN исходного файла.
Если GTIN импортный, то извлечение значения атрибута происходит из того экземпляра, который принадлежит указанному в столбце NK_MainAccountId  аккаунту.
Если в столбце NK_MainAccountId, это значит что значение атрибута скорректировано для всех аккаунтов и поэтому оно извлекается из самого первого объекта из массива attributes

## Исходные параметры:
Все исходные параметры задаются в файле params.yaml в котором:
- API_url - endpoint API
- apikey - ключ, предоставляемый участнику оборота
- DB_host - хост СУБД НК. (Запрос в СУБД использвется для получения ИНН по AccountId из исходного файла)
- DB_user - логин для подключения к СУБД
- DB_port - порт подключения к СУБД
- DB_password - пароль подключения к СУБД
- DB_database - название БД

#### Важно: в исходном файле должны присутствовать столбцы с названием 'NK_MainAccountId', 'NK_GTIN', 'NK_AttrId'

- input_folder - путь к папке, содержащей исходный файл
- input_file - название исходного файла
- sheet_name - название листа в исходном файле
- output_folder - путь к папке, содержащей файл с результатом парсинга
- output_file - название файла, содержащего файл с результатом парсинга
